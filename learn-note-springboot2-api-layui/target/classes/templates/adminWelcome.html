<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <title>欢迎页</title>
    <link rel="stylesheet" href="/layui/admin/layui-admin/frame/layui/css/layui.css">
    <link rel="stylesheet" href="/layui/admin/layui-admin/frame/static/css/style.css">
</head>
<body class="body">

<div class="layui-row layui-col-space10 my-index-main">
    <div class="layui-col-xs4 layui-col-sm3 layui-col-md3">
        <div class="my-nav-btn layui-clear" data-href="/admin/user/">
            <div class="layui-col-md5">
                <button class="layui-btn layui-btn-big layui-bg-black layui-icon">&#xe735;</button>
            </div>
            <div class="layui-col-md7 tc">
                <p class="my-nav-text" th:text="${admin_users}"></p>
                <p class="my-nav-text layui-elip">管理员</p>
            </div>
        </div>
    </div>
    <div class="layui-col-xs4 layui-col-sm3 layui-col-md3">
        <div class="my-nav-btn layui-clear" data-href="/admin/role/">
            <div class="layui-col-md5">
                <button class="layui-btn layui-btn-big layui-bg-black layui-icon">&#xe735;</button>
            </div>
            <div class="layui-col-md7 tc">
                <p class="my-nav-text" th:text="${admin_roles}"></p>
                <p class="my-nav-text layui-elip">角色</p>
            </div>
        </div>
    </div>
    <div class="layui-col-xs4 layui-col-sm3 layui-col-md3">
        <div class="my-nav-btn layui-clear" data-href="/customer/cashLog/">
            <div class="layui-col-md5">
                <button class="layui-btn layui-btn-big layui-btn-danger layui-icon">&#xe756;</button>
            </div>
            <div class="layui-col-md7 tc">
                <p class="my-nav-text" th:text="${today_sold_acount}"></p>
                <p class="my-nav-text layui-elip">销售总额</p>
            </div>
        </div>
    </div>
    <div class="layui-col-xs4 layui-col-sm3 layui-col-md3">
        <div class="my-nav-btn layui-clear" data-href="/customer/cashLog/">
            <div class="layui-col-md5">
                <button class="layui-btn layui-btn-big layui-btn-danger layui-icon">&#xe698;</button>
            </div>
            <div class="layui-col-md7 tc">
                <p class="my-nav-text" th:text="${today_sold_times}"></p>
                <p class="my-nav-text layui-elip">促销总次</p>
            </div>
        </div>
    </div>
    <!-- <div class="layui-col-xs4 layui-col-sm2 layui-col-md2">
        <div class="my-nav-btn layui-clear" data-href="./demo/progress-bar.html">
            <div class="layui-col-md5">
                <button class="layui-btn layui-btn-big layui-bg-cyan layui-icon">&#xe6b2;</button>
            </div>
            <div class="layui-col-md7 tc">
                <p class="my-nav-text" th:text="${items}"></p>
                <p class="my-nav-text layui-elip">...</p>
            </div>
        </div>
    </div>
    <div class="layui-col-xs4 layui-col-sm2 layui-col-md2">
        <div class="my-nav-btn layui-clear" data-href="./demo/folding-panel.html">
            <div class="layui-col-md5">
                <button class="layui-btn layui-btn-big layui-bg-black layui-icon">&#xe698;</button>
            </div>
            <div class="layui-col-md7 tc">
                <p class="my-nav-text">0</p>
                <p class="my-nav-text layui-elip">...</p>
            </div>
        </div>
    </div> -->

    <!-- 进度条
    <div class="layui-col-xs12 layui-col-sm6 layui-col-md6">
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">进度条</h2>
                <div class="layui-colla-content layui-show">

                    <div class="layui-progress">
                        <div class="layui-progress-bar" lay-percent="10%"></div>
                    </div>
                    <br/>
                    <div class="layui-progress" lay-showPercent="yes">
                        <div class="layui-progress-bar layui-bg-red" lay-percent="30%"></div>
                    </div>
                    <br/>
                    <div class="layui-progress layui-progress-big">
                        <div class="layui-progress-bar" lay-percent="20%"></div>
                    </div>
                    <br/>
                    <div class="layui-progress layui-progress-big">
                        <div class="layui-progress-bar layui-bg-orange" lay-percent="50%"></div>
                    </div>
                    <br/>
                    <div class="layui-progress layui-progress-big" lay-showPercent="true">
                        <div class="layui-progress-bar layui-bg-blue" lay-percent="80%"></div>
                    </div>

                </div>
            </div>
        </div>
    </div> -->
    <!-- <div class="layui-col-xs12 layui-col-sm6 layui-col-md6">
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">表格</h2>
                <div class="layui-colla-content layui-show">

                    <table class="layui-table">
                        <colgroup>
                            <col width="150">
                            <col width="200">
                            <col>
                        </colgroup>
                        <thead>
                        <tr>
                            <th>时间</th>
                            <th>店铺</th>
                            <th>促销额</th>
                        </tr>
                        </thead>
                        <tbody>
                        
                        <tr th:each="item,week : ${weekend_sold_detail}">
                            <td th:text="${week.name}"></td>
                            <td th:text="${week.name}"></td>
                            <td th:text="${week.name}"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div> -->

    
    <div class="layui-col-xs12 layui-col-sm6 layui-col-md6">
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">图表</h2>
                <div class="layui-colla-content layui-show">

                    <div id="main-line" style="height: 450px;"></div>

                </div>
            </div>
        </div>
    </div>
    <div class="layui-col-xs12 layui-col-sm6 layui-col-md6">
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">上月销售图标</h2>
                <div class="layui-colla-content layui-show">

                    <div id="main-line2" style="height: 450px;"></div>

                </div>
            </div>
        </div>
    </div>
    
    <div class="layui-col-xs12 layui-col-sm6 layui-col-md4">
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">版本</h2>
                <div class="layui-colla-content layui-show">
                    <ul class="layui-timeline max-auto">
                        <li class="layui-timeline-item">
                            <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
                            <div class="layui-timeline-content layui-text">
                                <div class="layui-timeline-title">开始于2019年06月10日</div>
                            </div>
                        </li>
                    </ul>

                </div>
            </div>
        </div>
    </div>
    <!-- <div class="layui-col-xs12 layui-col-sm6 layui-col-md4">
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">表单</h2>
                <div class="layui-colla-content layui-show">

                    <form class="layui-form max-auto" action="">
                        <div class="layui-form-item">
                            <label class="layui-form-label">输入框</label>
                            <div class="layui-input-block">
                                <input type="text" name="title" required lay-verify="required" placeholder="请输入标题"
                                       autocomplete="off" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">密码框</label>
                            <div class="layui-input-inline">
                                <input type="password" name="password" required lay-verify="required"
                                       placeholder="请输入密码" autocomplete="off" class="layui-input">
                            </div>
                            <div class="layui-form-mid layui-word-aux">辅助文字</div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">选择框</label>
                            <div class="layui-input-block">
                                <select name="city" lay-verify="required">
                                    <option value=""></option>
                                    <option value="0">北京</option>
                                    <option value="1">上海</option>
                                    <option value="2">广州</option>
                                    <option value="3">深圳</option>
                                    <option value="4">杭州</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">复选框</label>
                            <div class="layui-input-block">
                                <input type="checkbox" name="like[write]" title="写作">
                                <input type="checkbox" name="like[read]" title="阅读" checked>
                                <input type="checkbox" name="like[dai]" title="发呆">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">开关</label>
                            <div class="layui-input-block">
                                <input type="checkbox" name="switch" lay-skin="switch">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">单选框</label>
                            <div class="layui-input-block">
                                <input type="radio" name="sex" value="男" title="男">
                                <input type="radio" name="sex" value="女" title="女" checked>
                            </div>
                        </div>
                        <div class="layui-form-item layui-form-text">
                            <label class="layui-form-label">文本域</label>
                            <div class="layui-input-block">
                                <textarea name="desc" placeholder="请输入内容" class="layui-textarea"></textarea>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-input-block">
                                <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
                                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                            </div>
                        </div>
                    </form>

                </div>
            </div>
        </div>
    </div> -->
</div>

<script type="text/javascript" src="/layui/admin/layui-admin/frame/layui/layui.js"></script>
<script type="text/javascript" src="/layui/admin/layui-admin/frame/echarts/echarts.min.js"></script>
<script th:inline="javascript">
	layui.config({
	    base: './../layui/admin/layui-admin/frame/static/js/'   // 模块目录
	}).extend({                         // 模块别名
	    vip_nav: 'vip_nav'
	    , vip_tab: 'vip_tab'
	    , vip_table: 'vip_table'
	});

    layui.use(['element', 'form', 'table', 'layer', 'vip_tab'], function () {
        var form = layui.form
                , table = layui.table
                , layer = layui.layer
                , vipTab = layui.vip_tab
                , element = layui.element
                , $ = layui.jquery;

        
        var weekend_sold_detail = [[${weekend_sold_detail}]];
        initWeekend(weekend_sold_detail);
        
        var datashop = [[${mouth_sold_detail_s}]];
        var dataemployee = [[${mouth_sold_detail_e}]];
        initMouth(datashop,dataemployee)

        
        
        // 打开选项卡
        $('.my-nav-btn').on('click', function(){
            if($(this).attr('data-href')){
                //vipTab.add('','标题','路径');
                vipTab.add($(this),'<i class="layui-icon">'+$(this).find("button").html()+'</i>'+$(this).find('p:last-child').html(),$(this).attr('data-href'));
            }
        });

        function initMouth(datashop,dataemployee){
        	// 基于准备好的dom，初始化echarts实例
            var myChart2 = echarts.init(document.getElementById('main-line2'));
            
            var legend_data = [];
            var pie_in_data = [];
            var pie_out_data = [];
            
           	for (var shopname in datashop) {
           		legend_data.push(shopname);
           		var money = datashop[shopname];
           		
           		var obj = {};
           		obj["name"] = shopname;
           		obj["value"] = money;
           		pie_in_data.push(obj);
           	}
           	for (var employeename in dataemployee) {
           		legend_data.push(employeename);
           		var money = dataemployee[employeename];
           		
           		var obj = {};
           		obj["name"] = employeename;
           		obj["value"] = money;
           		pie_out_data.push(obj);
           	}
           	
            // 使用刚指定的配置项和数据显示图表。
            myChart2.setOption({
            	tooltip: {
                    trigger: 'item',
                    formatter: "{a} <br/>{b}: {c} ({d}%)"
                },
    			//下载，刷新，数据视图
                toolbox: {
    		        feature: {
    		            dataView: {show: true, readOnly: true},
    		            restore: {show: true},
    		            saveAsImage: {show: true}
    		        }
    		    },
    		    //简词
    		    legend: {
			        orient: 'vertical',
			        x: 'left',
			        data: legend_data
			    },
                //数据 name与legend对应
                series: [
                    {
                        name:'店铺月销售额',
                        type:'pie',
                        selectedMode: 'single',
                        radius: [0, '50%'],

                        label: {
                            normal: {
                                position: 'inner'
                            }
                        },
                        labelLine: {
                            normal: {
                                show: false
                            }
                        },
                        data:pie_in_data
                    },
                    {
                        name:'员工月销售额',
                        type:'pie',
                        radius: ['60%', '85%'],
                        label: {
                            normal: {
                                formatter: '{a|{a}}{abg|}\n{hr|}\n  {b|{b}：}{c}  {per|{d}%}  ',
                                backgroundColor: '#eee',
                                borderColor: '#aaa',
                                borderWidth: 1,
                                borderRadius: 4,
                                // shadowBlur:3,
                                // shadowOffsetX: 2,
                                // shadowOffsetY: 2,
                                // shadowColor: '#999',
                                // padding: [0, 7],
                                rich: {
                                    a: {
                                        color: '#999',
                                        lineHeight: 22,
                                        align: 'center'
                                    },
                                    // abg: {
                                    //     backgroundColor: '#333',
                                    //     width: '100%',
                                    //     align: 'right',
                                    //     height: 22,
                                    //     borderRadius: [4, 4, 0, 0]
                                    // },
                                    hr: {
                                        borderColor: '#aaa',
                                        width: '100%',
                                        borderWidth: 0.5,
                                        height: 0
                                    },
                                    b: {
                                        fontSize: 16,
                                        lineHeight: 33
                                    },
                                    per: {
                                        color: '#eee',
                                        backgroundColor: '#334455',
                                        padding: [2, 4],
                                        borderRadius: 2
                                    }
                                }
                            }
                        },
                        data:pie_out_data
                    }
                ]
            });
        }
        function initWeekend(data){
        	// 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('main-line'));
            
            var legend = {};
            legend.data = [];
            var xAxisData = [];
            var series = [];
            var shopnames = [];
           	for (var dateIndex in data) {
           		xAxisData.push(dateIndex);//日期放入x轴数组
           		//获取日期当天店铺销售额
           		sold_shop_detail = data[dateIndex];
           		
           		for (var shopName in sold_shop_detail) {
           			var money = sold_shop_detail[shopName];
           			
           			if($.inArray(shopName, shopnames)==-1){//如果没出现过
    	           		shopnames.push(shopName);
    	           		legend.data.push(shopName);
    	           		
    	           		var obj = {};
    	           		obj.name = shopName;
    	           		obj.type = 'bar';
    	           		obj.data = [];
    	           		obj.data.push(money);
    	           		series.push(obj);
           			}else{
           				//出现过，要把店铺对应数组找出来
           				for (var index in series){
           					var series_name = series[index]['name'];
           					if(series_name==shopName){
           						series[index]['data'].push(money);
    	       					break;
           					}
           				}
           			}
               		
                }
           	}
           	
            // 使用刚指定的配置项和数据显示图表。
            var colors = ['#5793f3', '#d14a61', '#675bba'];//柱状，折现颜色
            myChart.setOption({
            	color: colors,
            	tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross'
                    }
                },
              //右边偏移
//                 grid: {
//                     right: '20%'
//                 },
    			//下载，刷新，数据视图
                toolbox: {
    		        feature: {
    		            dataView: {show: true, readOnly: true},
    		            restore: {show: true},
    		            saveAsImage: {show: true}
    		        }
    		    },
    		    //简词
    		    legend: legend,
                title: {
                    text: '周销售额'
                },
                //X轴 数组
                xAxis: {
                	type: 'category',
                	axisTick: {
                        alignWithLabel: true
                    },
                    data: xAxisData
                },
                yAxis: {
                },
                //数据 name与legend对应
                series: series
            });
        }
    });
</script>
</body>
</html>